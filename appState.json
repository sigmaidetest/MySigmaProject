{"EDITOR_STATE":{"allProjectFiles":{"488301b8-fcaf-46eb-a24f-b6a86cfaa0d3":{"id":"488301b8-fcaf-46eb-a24f-b6a86cfaa0d3","parent":null,"name":"MySigmaProject","type":"DIRECTORY","isDirectory":true,"children":["5eb1fdf8-6adb-4b95-b083-38fee684062e"],"isRemovable":false,"filePath":"MySigmaProject"},"5eb1fdf8-6adb-4b95-b083-38fee684062e":{"id":"5eb1fdf8-6adb-4b95-b083-38fee684062e","parent":"488301b8-fcaf-46eb-a24f-b6a86cfaa0d3","name":"lambda.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"MySigmaProject/lambda.js","code":"let AWS = require('aws-sdk');\nlet validate = require('validate.js');\nconst ddb = new AWS.DynamoDB.DocumentClient();\n\nexports.handler = function (event, context, callback) {\n\n    var constraints = {\n        id: {\n            presence: true\n        },\n        name: {\n            presence: true,\n            length: {\n                minimum: 1\n            }\n        }\n    };\n\n    let invalid = validate(event, constraints);\n\n    if (!invalid) {\n        ddb.put({\n            TableName: 'MySigmaTable',\n            Item: { 'id': event.id, 'name': event.name }\n        }).promise().then(function (data) {\n            callback(null, {\n                \"isBase64Encoded\": true,\n                \"statusCode\": 200,\n                \"headers\": {\n                    \"Content-Type\": \"application/json\",\n                    \"Access-Control-Allow-Origin\": \"*\",\n                    \"Access-Control-Allow-Methods\": \"*\",\n                    \"Access-Control-Allow-Headers\": \"*\",\n                    \"Access-Control-Expose-Headers\": \"*,x-amzn-remapped-authorization\"\n                },\n                \"body\": JSON.stringify({\n                    \"Message\": \"Report successfully added to the table\",\n                    \"Item\": event\n                })\n            });\n        }).catch(function (err) {\n            callback(null, {\n                \"isBase64Encoded\": false,\n                \"statusCode\": err.statusCode,\n                \"headers\": {\n                    \"Content-Type\": \"application/json\",\n                    \"Access-Control-Allow-Origin\": \"*\",\n                    \"Access-Control-Allow-Methods\": \"*\",\n                    \"Access-Control-Allow-Headers\": \"*\",\n                    \"Access-Control-Expose-Headers\": \"*,x-amzn-remapped-authorization\"\n                },\n                \"body\": JSON.stringify({\n                    \"Code\": err.code,\n                    \"Message\": err.message\n                })\n            });\n        });\n    } else {\n        callback(JSON.stringify(invalid), null);\n    }\n}","triggers":[{"resourceName":"apigusEast1MySigmaAPIpublishpost","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"11acd7be-6c0d-467d-9cb0-c114eccbfb6f":{"id":"11acd7be-6c0d-467d-9cb0-c114eccbfb6f","name":"My report event","functionId":"5eb1fdf8-6adb-4b95-b083-38fee684062e","event":"{\n    \"id\": \"1\",\n    \"name\": \"sigma\"\n}"},"648c3a27-3ed4-4d65-8d41-2a247b36cfbc":{"id":"648c3a27-3ed4-4d65-8d41-2a247b36cfbc","name":"Error event","functionId":"5eb1fdf8-6adb-4b95-b083-38fee684062e","event":"{\n    \"name\": \"sigma-error\"\n}"}},"customSecurityPolicy":{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Resource":"*","Action":["athena:BatchGetNamedQuery"]}]}}},"deletedFiles":[],"rootNode":"488301b8-fcaf-46eb-a24f-b6a86cfaa0d3","openFiles":["5eb1fdf8-6adb-4b95-b083-38fee684062e"],"currentFileId":"5eb1fdf8-6adb-4b95-b083-38fee684062e","resources":{"apigusEast1MySigmaAPIpublishpost":{"name":"apigusEast1MySigmaAPIpublishpost","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"MySigmaAPI","endpointType":"EDGE","resourceMode":0,"resourceName":"publish","resourcePath":"/publish","restMethod":"POST","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"Prod"},"globallyEditable":true},"ddbMySigmaTable":{"name":"ddbMySigmaTable","type":"DynamoDB","config":{"mode":0,"operation":"put","table":{"arn":"","name":"MySigmaTable","partitionKey":"id","partitionKeyType":"S","hasSortKey":false,"sortKey":"","sortKeyType":"S","mode":0},"parameters":{"Key":{},"Item":{"id":"@{event.id}","name":"@{event.name}"},"ExpressionAttributeValues":{}},"validator":{"validatableFields":{},"validity":true},"valid":true},"globallyEditable":false}},"envVariables":[{"lambdaId":"all","varKey":"SIGMA_AWS_ACC_ID","varValue":null,"shouldPersist":false,"displayOnly":false,"editable":false}],"packageJSON":{"dependencies":{"aws-sdk":{"name":"aws-sdk","version":"2.176.0","notRemovable":true},"validate.js":{"name":"validate.js","version":"0.12.0"}}},"lambdaId":"5eb1fdf8-6adb-4b95-b083-38fee684062e"},"PROJECT_META":{"projectName":"MySigmaProject","projectDescription":"Sample Sigma Project","projectVersion":"1.0.0","projectRegion":"us-east-1","lastSave":1536906396164},"VCS_STATE":{"provider":"GitHub","repo":{"name":"MySigmaProject","url":"https://github.com/sigmaidetest/MySigmaProject"}}}